(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12033,        308]
NotebookOptionsPosition[     11597,        289]
NotebookOutlinePosition[     11977,        305]
CellTagsIndexPosition[     11934,        302]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"theta", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.", "           ", ",", "0.3141", "   ", ",", "0.6283", "  ", ",", 
       "0.9424", "  ", ",", "1.2566", "    ", ",", "1.5707", ",", "1.8849", 
       ",", "2.1991", ",", "2.5132", ",", "2.8274", ",", "3.1415"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.141"}], ",", 
       RowBox[{"-", "2.5132"}], ",", 
       RowBox[{"-", "1.8849"}], ",", 
       RowBox[{"-", "1.2566"}], ",", 
       RowBox[{"-", "0.62831"}], ",", " ", "0", "         ", ",", "0.6283", 
       ",", "1.256", "  ", ",", "1.8849", " ", ",", "2.5132", ",", 
       "3.14159"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ksmn", "[", 
     RowBox[{"s_", ",", "n_", ",", "m_", ",", "theta_", ",", "phi_"}], "]"}], 
    ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SqrtBox[
          FractionBox["2", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}]]], 
         RowBox[{"ExpresionSign", "[", "m", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "m", " ", 
           RowBox[{"phi", "[", 
            RowBox[{"[", "phiPos", "]"}], "]"}]}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "\[ImaginaryI]"}], ")"}], 
          RowBox[{"n", "+", "1"}]], " ", "1", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"LegendreDivision", "[", 
             RowBox[{"n", ",", "m", ",", 
              RowBox[{"theta", "[", 
               RowBox[{"[", "thetaPos", "]"}], "]"}]}], "]"}]}], " ", ",", 
           RowBox[{"-", 
            RowBox[{"LegendrePDerivadaCos", "[", 
             RowBox[{"n", ",", "m", ",", 
              RowBox[{"theta", "[", 
               RowBox[{"[", "thetaPos", "]"}], "]"}]}], "]"}]}]}], " ", 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SqrtBox[
          FractionBox["2", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}]]], 
         RowBox[{"ExpresionSign", "[", "m", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "m", " ", 
           RowBox[{"phi", "[", 
            RowBox[{"[", "phiPos", "]"}], "]"}]}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "\[ImaginaryI]"}], ")"}], "n"], " ", "1", " ", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"LegendrePDerivadaCos", "[", 
            RowBox[{"n", ",", "m", ",", 
             RowBox[{"theta", "[", 
              RowBox[{"[", "thetaPos", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"LegendreDivision", "[", 
             RowBox[{"n", ",", "m", ",", 
              RowBox[{"theta", "[", 
               RowBox[{"[", "thetaPos", "]"}], "]"}]}], "]"}]}]}], "}"}]}]}], 
       "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"thetaPos", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "theta", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"phiPos", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "phi", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.902134178971375*^9, 3.9021341808748207`*^9}, {
   3.9021342130919943`*^9, 3.902134328586059*^9}, {3.9021344757323723`*^9, 
   3.9021344801078186`*^9}, 3.902135004196454*^9, {3.9021477205518494`*^9, 
   3.9021479580990114`*^9}, {3.9021482509411416`*^9, 
   3.9021482525675373`*^9}, {3.9022296806422853`*^9, 
   3.9022297019836397`*^9}, {3.902229733063983*^9, 3.90222979049673*^9}, {
   3.9022298662154145`*^9, 3.90222989466247*^9}, {3.9022299321309195`*^9, 
   3.9022299429567623`*^9}, {3.9022299919438925`*^9, 3.9022300193923006`*^9}, 
   3.90223010347029*^9, {3.9022302402122855`*^9, 3.902230388953901*^9}, {
   3.9022304675886545`*^9, 3.902230535758167*^9}, {3.9022305872708793`*^9, 
   3.902230588827958*^9}, {3.9022306232862835`*^9, 3.9022306853579426`*^9}, {
   3.902230789469208*^9, 3.902230964589764*^9}, {3.9022310391173153`*^9, 
   3.9022310404225225`*^9}, {3.9022310917598057`*^9, 
   3.9022311100067487`*^9}, {3.902231248591734*^9, 3.902231303913557*^9}, 
   3.9022313342835546`*^9, {3.902231384695407*^9, 3.902231470280057*^9}, {
   3.9022319676721134`*^9, 3.9022320954513617`*^9}, 3.9022322490174036`*^9, 
   3.902313532723853*^9, {3.902313749858117*^9, 3.9023137608505063`*^9}, {
   3.902313798376275*^9, 3.9023138291455946`*^9}, {3.9023139602183423`*^9, 
   3.902313968265483*^9}, {3.902314183299535*^9, 3.9023142632312365`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vTsmn", "[", 
    RowBox[{
    "s_", ",", "m_", ",", "n_", ",", "z_", ",", "k_", ",", "eta_", ",", 
     "theta_", ",", "phi_", ",", "Etheta_", ",", "Ephi_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mtheta", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "theta", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"Nphi", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "phi", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"deltatheta", "=", 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"theta", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
       RowBox[{"deltaphi", "=", 
        RowBox[{
         RowBox[{"phi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"phi", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]"}], 
       SqrtBox[
        RowBox[{"6", " ", "\[Pi]"}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], 
      SuperscriptBox[
       RowBox[{"Rfunction", "[", 
        RowBox[{"s", ",", "n", ",", "3", ",", "z"}], "]"}], 
       RowBox[{"-", "2"}]], "deltatheta", " ", "deltaphi", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaPos", "=", "1"}], "Mtheta"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiPos", "=", "1"}], "Nphi"], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"EnormFactor", "[", 
             RowBox[{"eta", ",", "k"}], "]"}], 
            RowBox[{"Etheta", "[", 
             RowBox[{"[", "thetaPos", "]"}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"EnormFactor", "[", 
             RowBox[{"eta", ",", "k"}], "]"}], "*", 
            RowBox[{"Ephi", "[", 
             RowBox[{"[", "phiPos", "]"}], "]"}]}]}], "}"}], 
         RowBox[{"Fsmn", "[", 
          RowBox[{
           RowBox[{"3", "-", "s"}], ",", "m", ",", "n", ",", "3", ",", 
           RowBox[{"theta", "[", 
            RowBox[{"[", "thetaPos", "]"}], "]"}], ",", 
           RowBox[{"phi", "[", 
            RowBox[{"[", "phiPos", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{"theta", "[", 
           RowBox[{"[", "thetaPos", "]"}], "]"}], "]"}]}]}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vTsmn", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "10", ",", "1", ",", 
     RowBox[{"120", "Pi"}], ",", "theta", ",", "phi", ",", "theta", ",", 
     "phi"}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Mtheta", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "theta", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"Nphi", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "phi", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"deltatheta", "=", 
      RowBox[{
       RowBox[{"theta", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"theta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{"deltaphi", "=", 
      RowBox[{
       RowBox[{"phi", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"phi", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"thetaPos", "=", "1"}], "Mtheta"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"phiPos", "=", "1"}], "Nphi"], 
     RowBox[{"{", 
      RowBox[{"thetaPos", ",", "phiPos"}], "}"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9023152011070833`*^9, 3.902315201765543*^9}, {
   3.9023156499173427`*^9, 3.902315677216922*^9}, {3.902315723766006*^9, 
   3.902315812988826*^9}, {3.902315881694979*^9, 3.9023159116551113`*^9}, 
   3.9023159480383263`*^9, {3.9023159903297076`*^9, 3.902316011853875*^9}, {
   3.902316044887024*^9, 3.9023160542388697`*^9}, {3.9023161683187294`*^9, 
   3.9023161882545395`*^9}, {3.9023162213206816`*^9, 3.902316247621237*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"726", ",", "726"}], "}"}]], "Output",
 CellChangeTimes->{
  3.90231581453624*^9, 3.9023158824047966`*^9, 3.902315913853221*^9, 
   3.902315950366291*^9, 3.902316014750677*^9, {3.9023160501792035`*^9, 
   3.902316056969757*^9}, {3.9023161742175655`*^9, 3.9023161810170383`*^9}, {
   3.9023162242081385`*^9, 3.9023162493181005`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aux", " ", "=", " ", 
   RowBox[{"Ksmn", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "theta", ",", "phi"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dimensions", "[", "aux", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9022298711655126`*^9, 3.9022298807436805`*^9}, {
   3.9022302215179048`*^9, 3.9022302314699273`*^9}, {3.9022305487022223`*^9, 
   3.9022305614316735`*^9}, {3.9022306085610247`*^9, 3.902230609502514*^9}, {
   3.902230704510173*^9, 3.902230707454777*^9}, 3.9022307469134607`*^9, 
   3.9022309846552067`*^9, {3.902231471686844*^9, 3.902231509361621*^9}, 
   3.902232111108327*^9, {3.9022321470851045`*^9, 3.902232147889906*^9}, {
   3.9022322641548557`*^9, 3.90223226949819*^9}, {3.9023121973808513`*^9, 
   3.9023122156024847`*^9}, {3.902313537738436*^9, 3.902313563131906*^9}, {
   3.902313621166463*^9, 3.9023137755903635`*^9}, {3.9023142088950243`*^9, 
   3.9023142207208977`*^9}, 3.9023142957300177`*^9, {3.902315197074212*^9, 
   3.902315200448885*^9}, 3.902316242385724*^9}]
},
WindowSize->{1904, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.7000001668930054`,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 5094, 114, 529, "Input"],
Cell[CellGroupData[{
Cell[5676, 138, 4466, 119, 567, "Input"],
Cell[10145, 259, 371, 7, 49, "Output"]
}, Open  ]],
Cell[10531, 269, 1062, 18, 83, "Input"]
}
]
*)

(* End of internal cache information *)
