(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     68819,       1807]
NotebookOptionsPosition[     66136,       1724]
NotebookOutlinePosition[     66514,       1740]
CellTagsIndexPosition[     66471,       1737]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[Cell["Definici\[OAcute]n de las ecuaciones", "Section",
  CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
    3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
    3.9305642406184607`*^9, 3.9305642583580275`*^9}}]], "Input",
 CellChangeTimes->{{3.924761210600356*^9, 3.9247612197898817`*^9}, {
   3.924762033205001*^9, 3.9247620521310835`*^9}, 3.9305643925989428`*^9, {
   3.930564481122533*^9, 3.9305645151026487`*^9}, 3.9305648680405216`*^9, 
   3.930731916383336*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9307319133794203`*^9, 3.9307319142773027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hRDer", "[", 
   RowBox[{"n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "n"}], ")"}], " ", 
    RowBox[{"SphericalHankelH1", "[", 
     RowBox[{"n", ",", 
      RowBox[{"k", " ", "R"}]}], "]"}]}], "-", 
   RowBox[{"k", " ", "R", " ", 
    RowBox[{"SphericalHankelH1", "[", 
     RowBox[{
      RowBox[{"1", "+", "n"}], ",", 
      RowBox[{"k", " ", "R"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9305644854589925`*^9, 3.9305644917893476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma", "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "n"}], "+", "1"}], ")"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "m"}], ")"}], "!"}], "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi", " ", "n", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "m"}], ")"}], "!"}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.924762421118188*^9, 3.9247624268175144`*^9}, {
   3.9257069143791065`*^9, 3.9257069293059607`*^9}, 3.930564397214538*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pfunc", "[", 
   RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", "m", ",", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}], ",", "0", ",", "0"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.9247707273442774`*^9, 3.9247707360147734`*^9}, {
   3.92477086603321*^9, 3.9247709196132746`*^9}, 3.924770953257199*^9, 
   3.930564410622275*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LegendrePDer", "[", 
    RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "m", "+", "1"}], ")"}], " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", 
         RowBox[{"m", "-", "1"}], ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], "-", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"n", ",", 
        RowBox[{"m", "+", "1"}], ",", 
        RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9247715416188507`*^9, 3.9247715534185257`*^9}, 
   3.9305644119824295`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendrePDerSin", "[", 
   RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sin", "[", "theta", "]"}], " ", 
   RowBox[{"LegendrePDer", "[", 
    RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.924771685424076*^9, 3.9247717020630283`*^9}, 
   3.9305644158933897`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mLegendrePDividedBySin", "[", 
    RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"n", "-", "1"}], ",", 
        RowBox[{"m", "+", "1"}], ",", 
        RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "m", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "+", "m"}], ")"}], " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", 
         RowBox[{"m", "-", "1"}], ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.924772100219801*^9, 3.924772110650398*^9}, 
   3.9305644198098855`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BSinfunc", "[", 
    RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"LegendrePDerSin", "[", 
       RowBox[{"n", ",", "m", ",", "theta"}], "]"}], ",", 
      RowBox[{"I", " ", "m", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", "m", ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}]}], "}"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9247735493586874`*^9, 3.92477356549261*^9}, {
  3.9303632647334385`*^9, 3.930363282142979*^9}, {3.930564422702577*^9, 
  3.930564431310775*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CSinfunc", "[", 
    RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"I", " ", "m", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", "m", ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"LegendrePDerSin", "[", 
        RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9247737234076424`*^9, 3.924773741449674*^9}, 
   3.930564426182645*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MSinfunc", "[", 
    RowBox[{
    "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"gamma", "[", 
     RowBox[{"m", ",", "n"}], "]"}], " ", 
    RowBox[{"SphericalHankelH1", "[", 
     RowBox[{"n", ",", 
      RowBox[{"k", " ", "R"}]}], "]"}], " ", 
    RowBox[{"CSinfunc", "[", 
     RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.924773951477687*^9, 3.9247739972113028`*^9}, 
   3.924774076481837*^9, 3.930564434326153*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NSinfunc", "[", 
   RowBox[{
   "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"gamma", "[", 
    RowBox[{"m", ",", "n"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], " ", 
      RowBox[{
       RowBox[{"SphericalHankelH1", "[", 
        RowBox[{"n", ",", 
         RowBox[{"k", " ", "R"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", "R"}], ")"}]}], " ", 
      RowBox[{"Pfunc", "[", 
       RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"hRDer", "[", 
        RowBox[{"n", ",", "k", ",", "R"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", "R"}], ")"}]}], " ", 
      RowBox[{"BSinfunc", "[", 
       RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9247740733056555`*^9, 3.9247740796880207`*^9}, {
   3.9247743665624285`*^9, 3.924774382857361*^9}, 3.9305644612263203`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bfunc", "[", 
   RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"LegendrePDer", "[", 
      RowBox[{"n", ",", "m", ",", "theta"}], "]"}], ",", 
     RowBox[{"I", " ", 
      RowBox[{"mLegendrePDividedBySin", "[", 
       RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.924774811697889*^9, 3.924774817453218*^9}, 
   3.9305644540143347`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cfunc", "[", 
   RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"I", " ", 
      RowBox[{"mLegendrePDividedBySin", "[", 
       RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"LegendrePDer", "[", 
       RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.924775018825736*^9, 3.9247750265451775`*^9}, 
   3.930564448962908*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9247747961620007`*^9, 3.92477480962177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afunc", "[", 
   RowBox[{"gdata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"gamma", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"gdata", "[", 
     RowBox[{"[", "n", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], 
   RowBox[{"1", "/", 
    RowBox[{"SphericalHankelH1", "[", 
     RowBox[{"n", ",", 
      RowBox[{"k", " ", "R"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.924856796431572*^9, 3.9248569059907923`*^9}, {
   3.924857279078083*^9, 3.924857286198099*^9}, {3.9248575191047735`*^9, 
   3.9248575216947746`*^9}, {3.924857574846012*^9, 3.9248575848455067`*^9}, {
   3.924857805956251*^9, 3.9248578228776646`*^9}, 3.93056444475112*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfunc", "[", 
   RowBox[{"edata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"gamma", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"edata", "[", 
     RowBox[{"[", "n", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], "k", " ", 
   RowBox[{"R", "/", 
    RowBox[{"hRDer", "[", 
     RowBox[{"n", ",", "k", ",", "R"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.924858156661023*^9, 3.9248581846843863`*^9}, 
   3.930564466428938*^9}],

Cell[CellGroupData[{

Cell["Lectura de datos", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fileEx", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ex.txt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileEy", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ey.txt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileEz", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ez.txt\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.930564332475895*^9, 3.930564337155149*^9}, {
   3.9305646818613586`*^9, 3.930564683741576*^9}, 3.9310628014439063`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"En", " ", "esta", " ", "celda"}], ",", " ", 
    RowBox[{
    "leemos", " ", "las", " ", "8", " ", "primeras", " ", "lineas", " ", "de",
      " ", "los", " ", 
     RowBox[{"ficheros", ".", " ", "Las"}], " ", "cuales", " ", "coinciden", 
     " ", "con", " ", "las", " ", "cabeceras", " ", "del", " ", 
     "m\[IAcute]smo"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEx", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEy", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEz", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"En", " ", "estas", " ", "celdas"}], ",", " ", 
     RowBox[{
     "mostramos", " ", "lo", " ", "leido", " ", "en", " ", "la", " ", "celda",
       " ", 
      RowBox[{"anterior", ".", " ", "De"}], " ", "esta", " ", "forma"}], ",", 
     " ", 
     RowBox[{
     "nos", " ", "aseguramos", " ", "de", " ", "que", " ", "hemos", " ", 
      "leido", " ", "las", " ", 
      RowBox[{"cabeceras", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"headerdataEx", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEx", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"headerdataEy", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEy", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"headerdataEz", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEz", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataEx", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEx", ",", "String"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dataEy", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEy", ",", "String"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dataEz", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEz", ",", "String"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.930565217538348*^9, {3.930731925163846*^9, 3.930731933323163*^9}, {
   3.93106280544018*^9, 3.93106283490984*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Cerramos", " ", "el", " ", "objeto", " ", "que", " ", "lee", " ", "los", 
    " ", "archivos"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Close", "[", "fileEx", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", "fileEy", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", "fileEz", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914148311409674`*^9, 3.8914148350005474`*^9}, {
  3.891415741600342*^9, 3.891415742666151*^9}, {3.8918567644166265`*^9, 
  3.8918567892492003`*^9}, {3.930564693189658*^9, 3.9305646947253056`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Esta", " ", "celda", " ", "nos", " ", "permite", " ", "separar", " ", 
    "la", " ", "cadena", " ", "de", " ", "texto", " ", "en", " ", 
    RowBox[{"diversas", ".", " ", "Emplea"}], " ", "espacios", " ", "en", " ",
     "blanco", " ", "como", " ", "separado"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datasetExSplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEx", ",", "\"\<;\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetEySplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEy", ",", "\"\<;\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetEzSplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEz", ",", "\"\<;\>\""}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914185203912582`*^9, 3.891418532791583*^9}, {
   3.891856813849495*^9, 3.8918568796887083`*^9}, {3.8918589532049875`*^9, 
   3.8918589535264177`*^9}, 3.8918592288209295`*^9, {3.931062851372012*^9, 
   3.931062853704591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ex"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEx", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetExSplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
   3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
   3.9308839865149612`*^9}, {3.9308845760636473`*^9, 
   3.9308845856561885`*^9}, {3.9310628646173983`*^9, 3.9310628834581995`*^9}, 
   3.9310644206298103`*^9, {3.9310647394260883`*^9, 3.9310647480310116`*^9}, {
   3.9310647986824894`*^9, 3.931064883573431*^9}, {3.931065021205163*^9, 
   3.931065046298027*^9}, {3.9310651247316475`*^9, 3.931065135550496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ey"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEy", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetEySplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
  3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
  3.930884035746376*^9}, {3.93088459317561*^9, 3.930884597983731*^9}, {
  3.931065029609804*^9, 3.9310650599979296`*^9}, {3.9310651037164764`*^9, 
  3.931065106002347*^9}, {3.931065139275794*^9, 3.9310651453613615`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ez"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEz", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetEzSplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
  3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
  3.930884080754927*^9}, {3.9308846023274417`*^9, 3.930884606735462*^9}, {
  3.93106514978941*^9, 3.931065163324697*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creaci\[OAcute]n de los interpoladores", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ex"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ExComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEx", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEx", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"ExComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876066961856`*^9}, {3.9308876410230155`*^9, 3.9308876413734975`*^9}, 
   3.930887692749398*^9, {3.931065314146558*^9, 3.9310653570373597`*^9}, 
   3.9310661591206875`*^9, 3.9310804095864735`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ey"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EyComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEy", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEy", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EyInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"EyComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876943263874`*^9}, {3.931065365124513*^9, 3.9310653865424385`*^9}, 
   3.93106616075031*^9, 3.9310804081938114`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ez"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EzComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEz", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEz", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EzInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"EzComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876943263874`*^9}, {3.9308877361430407`*^9, 3.930887769533637*^9}, {
   3.9310653918917236`*^9, 3.9310654073675804`*^9}, 3.9310661615616713`*^9, 
   3.931080407305518*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Generaci\[OAcute]n de un conjunto de valores r, theta y phi con los que \
creamos una malla\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.931059235483864*^9, 3.9310592409718647`*^9}, 3.931141692908883*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thetaIni", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "Pi"}], "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaEnd", " ", "=", " ", 
   RowBox[{"Pi", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiIni", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiEnd", " ", "=", " ", 
   RowBox[{"2", "Pi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberOfValues", " ", "=", " ", "100"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9308884678725624`*^9, 3.930888484547901*^9}, {
   3.9308892542062325`*^9, 3.930889308390233*^9}, 3.931055709353503*^9, 
   3.931141692908883*^9, 3.93115091646986*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rLinspace", "=", 
   RowBox[{"{", "0.01", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaLinspace", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"thetaIni", ",", "thetaEnd"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLinspace", " ", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"phiIni", ",", "phiEnd"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.930887954968811*^9, 3.9308879623976808`*^9}, {
   3.9308880214336104`*^9, 3.930888049517823*^9}, {3.930888089627796*^9, 
   3.930888124038452*^9}, {3.93088817864353*^9, 3.9308882054030805`*^9}, {
   3.9308883427941637`*^9, 3.930888358538164*^9}, {3.9308884324499207`*^9, 
   3.9308884380343275`*^9}, {3.9308887911204104`*^9, 
   3.9308888019454107`*^9}, {3.93088897085616*^9, 3.9308889711591597`*^9}, {
   3.9308891790882816`*^9, 3.930889245286233*^9}, {3.930889301015232*^9, 
   3.930889322983232*^9}, {3.9310526672970595`*^9, 3.931052679741494*^9}, {
   3.9310528359217973`*^9, 3.9310528448838844`*^9}, {3.9310554676709166`*^9, 
   3.9310555604217253`*^9}, {3.931055849269913*^9, 3.931055870418481*^9}, {
   3.931056432673195*^9, 3.9310564333689084`*^9}, 3.931141692908883*^9, 
   3.9311467010550737`*^9, {3.931147162327526*^9, 3.931147163307892*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meshGrid", " ", "=", " ", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{"rLinspace", ",", "thetaLinspace", ",", "phiLinspace"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "rLinspace", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "thetaLinspace", "]"}]}], "]"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "phiLinspace", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.931055563772594*^9, {3.9310556273833055`*^9, 3.9310556285263643`*^9}, {
   3.931058334688697*^9, 3.931058334905045*^9}, 3.93105930286038*^9, {
   3.9311416536109104`*^9, 3.9311416544036393`*^9}, 3.931141692909882*^9, {
   3.9311466346257286`*^9, 3.931146638395994*^9}, {3.9311467355749464`*^9, 
   3.931146753202015*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformar los valores r, theta y phi en cartesianas", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.9310592477878637`*^9, 3.931059248139864*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xValueFromSpherical", " ", "=", " ", 
   RowBox[{"rGrid", "*", 
    RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
    RowBox[{"Cos", "[", "phiGrid", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yValueFromSpherical", " ", "=", " ", 
   RowBox[{"rGrid", "*", 
    RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
    RowBox[{"Sin", "[", "phiGrid", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zValueFromSpherical", " ", "=", " ", 
    RowBox[{"rGrid", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsToInterpolate", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
     "xValueFromSpherical", ",", "yValueFromSpherical", ",", 
      "zValueFromSpherical"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9310530164186788`*^9, 3.9310531154476333`*^9}, {
   3.9310539918276224`*^9, 3.931054036435073*^9}, {3.931054171476544*^9, 
   3.9310541889146147`*^9}, 3.931054663667223*^9, 3.931056330380823*^9, {
   3.9310588015570574`*^9, 3.931058828235508*^9}, {3.9310590559449987`*^9, 
   3.931059059557906*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculamos los valroes Ex, Ey y Ez interpolados", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ExInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EyInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"EyInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"EzInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931059136308901*^9, 3.9310591997051663`*^9}, {
  3.931066677817153*^9, 3.9310667015299544`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Cambiamos las coordenadas de las componentes Ex, Ey y Ez a esf\[EAcute]ricas\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}, {
   3.931143926811343*^9, 3.931143945503505*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Er", " ", "=", "  ", 
   RowBox[{
    RowBox[{"ExInterpolated", " ", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", " ", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EzInterpolated", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Etheta", " ", "=", " ", 
   RowBox[{
    RowBox[{"ExInterpolated", " ", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}], "*", " ", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}], "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "-", " ", 
    RowBox[{"EzInterpolated", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ephi", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ExInterpolated"}], " ", "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931143955254555*^9, 3.931144055169664*^9}, {
  3.931144088881974*^9, 3.9311440969049025`*^9}, {3.931144562518724*^9, 
  3.9311445764785547`*^9}, {3.9311453801333046`*^9, 3.9311453819486847`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculamos los valores emn y gmn\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}, {
   3.931143926811343*^9, 3.931143945503505*^9}, {3.931144694655033*^9, 
   3.9311447059137754`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberOfModes", " ", "=", " ", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.9311455737413845`*^9, 3.931145577850969*^9}, {
   3.9311462608962164`*^9, 3.9311463208718033`*^9}, 3.931146378143506*^9, {
   3.9311468086471815`*^9, 3.9311468277762566`*^9}}],

Cell[BoxData[
 RowBox[{"deltaTheta", " ", "=", " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"thetaLinspace", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "-", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{"thetaLinspace", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9311468295892096`*^9, 3.931146831172411*^9}, {
  3.931151036541992*^9, 3.9311510781326694`*^9}, {3.931151404580779*^9, 
  3.931151416036036*^9}, {3.9311514604980774`*^9, 3.931151482979184*^9}, {
  3.9311515273322163`*^9, 3.931151529432512*^9}}],

Cell[BoxData[
 RowBox[{"deltaPhi", " ", "=", " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"phiLinspace", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "-", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{"phiLinspace", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9311468326560755`*^9, 3.9311468327540765`*^9}, {
  3.93115105613433*^9, 3.9311510808864517`*^9}, {3.9311514867095137`*^9, 
  3.9311515257676897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"emn", " ", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"n", "=", "1"}], "numberOfModes"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"m", "=", 
       RowBox[{"-", "n"}]}], "n"], " ", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"thetaIndex", "=", "1"}], 
       RowBox[{"Length", "[", "thetaGrid", "]"}]], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"phiIndex", "=", "1"}], 
        RowBox[{"Length", "[", "phiGrid", "]"}]], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Er", "[", 
           RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
          RowBox[{"Etheta", "[", 
           RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "0"}], "}"}], ".", 
        RowBox[{"BSinfunc", "[", 
         RowBox[{
          RowBox[{"-", "m"}], ",", "n", ",", 
          RowBox[{"thetaGrid", "[", 
           RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
          RowBox[{"phiGrid", "[", 
           RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9311447752487383`*^9, 3.9311448175586605`*^9}, {
   3.931145090181898*^9, 3.9311451314789515`*^9}, {3.9311452978353343`*^9, 
   3.931145333825146*^9}, 3.9311454184085674`*^9, {3.931145527590138*^9, 
   3.931145650378984*^9}, {3.9311457550285435`*^9, 3.9311457652187543`*^9}, {
   3.931145986897256*^9, 3.931145993858419*^9}, {3.931146044313921*^9, 
   3.931146046440615*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"emn", " ", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"deltaTheta", "*", "deltaPhi", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaIndex", "=", "1"}], 
        RowBox[{"Length", "[", "thetaLinspace", "]"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiIndex", "=", "1"}], 
         RowBox[{"Length", "[", "phiLinspace", "]"}]], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Er", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"Etheta", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "0"}], "}"}], ".", 
         RowBox[{"BSinfunc", "[", 
          RowBox[{
           RowBox[{"-", "m"}], ",", "n", ",", 
           RowBox[{"thetaLinspace", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"phiLinspace", "[", 
            RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"emn", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9311460558629723`*^9, 3.9311460753971663`*^9}, {
   3.931146360912691*^9, 3.9311463627605553`*^9}, {3.9311515555817404`*^9, 
   3.9311515760940557`*^9}, 3.9311529214218645`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.00955189755409334`"}], "+", 
          RowBox[{"0.01489179741005841`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.9363792129937777`"}], "+", 
          RowBox[{"1.4566834008295535`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.004775948777046664`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.007445898705029208`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.03754154397520801`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.058451954400487345`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.00047160669533942104`"}], "+", 
          RowBox[{"0.000862453224779145`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.877077198760395`"}], "+", 
          RowBox[{"2.9225977200243585`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00007860111588989862`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.00014374220412985734`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.001564230998967004`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.0024354981000203066`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.19660118634785495`"}], "+", 
          RowBox[{"0.30581179524015917`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0539338217443372`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.08442947845741441`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.040989207849367236`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.06355511315972842`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.8352762420660613`"}], "+", 
          RowBox[{"2.86384137511979`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0034157673207805784`"}], "+", 
          RowBox[{"0.005296259429977364`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00044944851453614256`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.0007035789871451195`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00027305720326090886`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.0004247386045002209`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.3340682600038511`", "\[VeryThinSpace]", "-", 
          RowBox[{"2.073598098155856`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.5116366168610939`"}], "+", 
          RowBox[{"0.7981545927924661`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.10391097037380449`"}], "+", 
          RowBox[{"0.16001973307061776`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.08370074715905036`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.1301509213828136`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6983062458519584`"}], "+", 
          RowBox[{"1.1020003244318217`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.004185037357952538`"}], "+", 
          RowBox[{"0.006507546069140674`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.00028864158437167964`"}], "+", 
          RowBox[{"0.0004444992585294946`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00010151520175815358`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.00015836400650644174`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00003308701041676216`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.000051428524259817913`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11.219957446451318`"}], "+", 
          RowBox[{"17.429402173966476`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"4.9367754092225695`", "\[VeryThinSpace]", "-", 
          RowBox[{"7.688696449820753`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.10514550548573019`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.15197082025881048`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.44525914932673444`"}], "+", 
          RowBox[{"0.6904430591015578`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0773274619706188`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.12073923160774075`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.660688613289292`", "\[VeryThinSpace]", "-", 
          RowBox[{"1.0105213126750545`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.002577582065687284`"}], "+", 
          RowBox[{"0.004024641053591354`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.00053007041586516`"}], "+", 
          RowBox[{"0.0008219560227399499`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "5.215550867347797`*^-6"}], "+", 
          RowBox[{"7.538235131885332`*^-6", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.000013604429588907004`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.000021187986248403738`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"3.0919194903139635`*^-6", "-", 
          RowBox[{"4.803075995912277`*^-6", " ", "\[ImaginaryI]"}]}]}], "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.93115172000749*^9, 3.9311529214228635`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9311459587055187`*^9, 3.9311459611286*^9}, {
   3.9311462970723343`*^9, 3.9311463012774086`*^9}, {3.9311463576189957`*^9, 
   3.9311463665195866`*^9}, 3.9311515746675587`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edipoler", "[", 
   RowBox[{
   "r_", ",", "theta_", ",", "k_", ",", "eta_", ",", "l_", ",", "I0_"}], 
   "]"}], ":=", 
  RowBox[{"eta", " ", "I0", " ", "l", " ", 
   RowBox[{
    RowBox[{"Cos", "[", "theta", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "Pi", " ", 
      RowBox[{"r", "^", "2"}]}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "k", " ", "r"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "k", " ", "r"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Edipoletheta", "[", 
   RowBox[{
   "r_", ",", "theta_", ",", "k_", ",", "eta_", ",", "l_", ",", "I0_"}], 
   "]"}], ":=", 
  RowBox[{"I", " ", "eta", " ", "k", " ", "I0", " ", "l", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", "r"}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "k", " ", "r"}], ")"}]}], "-", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", " ", "r"}], ")"}], "^", "2"}]}]}], ")"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "k", " ", "r"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.913206954070815*^9, 3.9132070565034614`*^9}, {
  3.9132070878933434`*^9, 3.913207090154496*^9}, {3.9132074408272057`*^9, 
  3.913207441315274*^9}, {3.9311470805268173`*^9, 3.93114708074496*^9}, {
  3.9311477488994274`*^9, 3.93114775121959*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"1", " ", "lambda"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"lambda", "/", "50"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"k", "=", 
    RowBox[{"2", " ", 
     RowBox[{"Pi", "/", "lambda"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "=", 
   RowBox[{"120", " ", "Pi"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.931147261078245*^9, 3.9311472912998533`*^9}, 
   3.9311479672134857`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"emnDipoloTeorico", " ", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"deltaTheta", "*", "deltaPhi", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaIndex", "=", "1"}], 
        RowBox[{"Length", "[", "thetaLinspace", "]"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiIndex", "=", "1"}], 
         RowBox[{"Length", "[", "phiLinspace", "]"}]], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Edipoletheta", "[", 
            RowBox[{"r", ",", 
             RowBox[{"thetaLinspace", "[", 
              RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "k", ",", "eta", 
             ",", "l", ",", "I0"}], "]"}], ",", "0"}], "}"}], ".", 
         RowBox[{"BSinfunc", "[", 
          RowBox[{
           RowBox[{"-", "m"}], ",", "n", ",", 
           RowBox[{"thetaLinspace", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"phiLinspace", "[", 
            RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"emnDipoloTeorico", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9311470922164783`*^9, 3.9311470953835382`*^9}, {
   3.931147319310111*^9, 3.9311473312784185`*^9}, 3.9311475270888247`*^9, {
   3.931147735451861*^9, 3.931147737676602*^9}, {3.931151364333741*^9, 
   3.931151367452381*^9}, {3.9311517580207143`*^9, 3.9311517786592536`*^9}, {
   3.931152692913085*^9, 3.931152693258767*^9}, {3.931152881953318*^9, 
   3.931152882791727*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.016790570063621592`"}], "-", 
            RowBox[{"0.10282596089996056`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1.6393077552846615`"}], "-", 
            RowBox[{"10.039170469447718`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.00839528503181082`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.051412980449980265`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.06582960667995022`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.4031425101639652`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.001097224564344075`"}], "-", 
            RowBox[{"0.00671943654826675`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "3.2914803339974945`"}], "-", 
            RowBox[{"20.157125508198177`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.00018287076072402331`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.0011199060913777942`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.00274290027833126`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.016797604590165216`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.34412060816541096`"}], "-", 
            RowBox[{"2.1074050533133017`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.0955336815141003`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.5850511663854342`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.0713168837009757`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.4367467612568849`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "3.2315357805196605`"}], "-", 
            RowBox[{"19.790023242538247`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.005943073641747922`"}], "-", 
            RowBox[{"0.03639556343807373`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.0007961140126175005`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.004875426386545282`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.00047794528911862636`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.0029269514629351396`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2.3318426170675184`", "\[VeryThinSpace]", "+", 
            RowBox[{"14.28027499119523`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.9004157468721139`"}], "-", 
            RowBox[{"5.514173374147523`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.17847720833450786`"}], "-", 
            RowBox[{"1.0929998431381387`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.1464118759308704`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.8966307738636958`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1.2555902088770083`"}], "-", 
            RowBox[{"7.689272564014016`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.0073205937965436126`"}], "-", 
            RowBox[{"0.0448315386931848`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.0004957700231514101`"}], "-", 
            RowBox[{"0.003036110675383723`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.0001786539180301805`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.0010940820186800646`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.000057833398240761874`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.0003541734868848023`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "19.589928297754895`"}], "-", 
            RowBox[{"119.96931572575211`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"8.661330009678458`", "\[VeryThinSpace]", "+", 
            RowBox[{"53.04224797265469`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.15958712024599123`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.9773163701037823`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.7748192310143681`"}], "-", 
            RowBox[{"4.745016497411078`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.1363165652181553`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.8348067845241224`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1.1202287821226695`", "\[VeryThinSpace]", "+", 
            RowBox[{"6.860315076444213`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.004543885507271815`"}], "-", 
            RowBox[{"0.02782689281747074`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "0.0009224038464456838`"}], "-", 
            RowBox[{"0.005648829163584617`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "7.916027789979592`*^-6"}], "-", 
            RowBox[{"0.00004847799454879812`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"0.000023868303598099744`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.0001461702159740263`", " ", "\[ImaginaryI]"}]}], ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"5.3984590767622825`*^-6", "+", 
            RowBox[{"0.000033060327305377034`", " ", "\[ImaginaryI]"}]}], ",",
            "0"}], "}"}]}], "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.931152841658574*^9}]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "5.026554096029985`"}], "-", 
          RowBox[{"30.78276991081698`", " ", "\[ImaginaryI]"}]}], ",", "0"}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.00003530434288576611`"}], "-", 
          RowBox[{"0.00021620486781692184`", " ", "\[ImaginaryI]"}]}], ",", 
         "0", ",", "0", ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.00008918356625527406`"}], "-", 
          RowBox[{"0.0005461628677224141`", " ", "\[ImaginaryI]"}]}], ",", 
         "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input"]
}, Open  ]]
},
WindowSize->{1904, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.600000023841858,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 526, 7, 87, "Input"],
Cell[1086, 29, 96, 1, 47, "Input"],
Cell[1185, 32, 546, 16, 47, "Input"],
Cell[1734, 50, 694, 21, 47, "Input"],
Cell[2431, 73, 578, 15, 47, "Input"],
Cell[3012, 90, 844, 25, 77, "Input"],
Cell[3859, 117, 366, 9, 47, "Input"],
Cell[4228, 128, 907, 27, 77, "Input"],
Cell[5138, 157, 745, 18, 77, "Input"],
Cell[5886, 177, 696, 18, 77, "Input"],
Cell[6585, 197, 607, 16, 77, "Input"],
Cell[7195, 215, 1154, 33, 77, "Input"],
Cell[8352, 250, 584, 15, 47, "Input"],
Cell[8939, 267, 607, 16, 47, "Input"],
Cell[9549, 285, 93, 1, 47, "Input"],
Cell[9645, 288, 962, 25, 47, "Input"],
Cell[10610, 315, 744, 22, 47, "Input"],
Cell[CellGroupData[{
Cell[11379, 341, 233, 3, 125, "Section"],
Cell[11615, 346, 1016, 26, 367, "Input"],
Cell[12634, 374, 2537, 71, 338, "Input"],
Cell[15174, 447, 664, 15, 135, "Input"],
Cell[15841, 464, 1116, 26, 135, "Input"],
Cell[16960, 492, 2167, 52, 222, "Input"],
Cell[19130, 546, 2026, 50, 222, "Input"],
Cell[21159, 598, 1927, 49, 222, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23123, 652, 307, 4, 125, "Section"],
Cell[23433, 658, 1722, 40, 135, "Input"],
Cell[25158, 700, 1643, 39, 135, "Input"],
Cell[26804, 741, 1698, 40, 135, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28539, 786, 492, 8, 125, "Section"],
Cell[29034, 796, 709, 17, 164, "Input"],
Cell[29746, 815, 1562, 32, 164, "Input"],
Cell[31311, 849, 1672, 45, 135, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33020, 899, 523, 6, 125, "Section"],
Cell[33546, 907, 1214, 28, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34797, 940, 517, 6, 125, "Section"],
Cell[35317, 948, 2463, 68, 193, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37817, 1021, 604, 9, 125, "Section"],
Cell[38424, 1032, 1481, 35, 106, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39942, 1072, 612, 10, 125, "Section"],
Cell[40557, 1084, 287, 5, 47, "Input"],
Cell[40847, 1091, 603, 13, 47, InheritFromParent],
Cell[41453, 1106, 503, 12, 47, InheritFromParent],
Cell[41959, 1120, 1520, 38, 163, "Input"],
Cell[CellGroupData[{
Cell[43504, 1162, 1502, 37, 281, "Input"],
Cell[45009, 1201, 6035, 123, 157, "Output"]
}, Open  ]],
Cell[51059, 1327, 224, 3, 47, "Input"],
Cell[51286, 1332, 1616, 46, 77, "Input"],
Cell[52905, 1380, 709, 20, 222, "Input"],
Cell[CellGroupData[{
Cell[53639, 1404, 1793, 41, 281, "Input"],
Cell[55435, 1447, 9004, 225, 177, "Output"]
}, Open  ]],
Cell[64454, 1675, 1666, 46, 146, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
