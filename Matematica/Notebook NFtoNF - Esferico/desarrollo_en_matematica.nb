(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     79456,       2091]
NotebookOptionsPosition[     76285,       1989]
NotebookOutlinePosition[     76663,       2005]
CellTagsIndexPosition[     76620,       2002]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[Cell[BoxData[Cell["Definici\[OAcute]n de las ecuaciones", 
  "Section",
  CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
    3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
    3.9305642406184607`*^9, 3.9305642583580275`*^9}}]]]], "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.931324771457213*^9, 
   3.9313247800745745`*^9}, 3.9313270673951235`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hRDer", "[", 
     RowBox[{"n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "n"}], ")"}], " ", 
      RowBox[{"SphericalHankelH1", "[", 
       RowBox[{"n", ",", 
        RowBox[{"k", " ", "R"}]}], "]"}]}], "-", 
     RowBox[{"k", " ", "R", " ", 
      RowBox[{"SphericalHankelH1", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"k", " ", "R"}]}], "]"}]}]}]}], "\n", 
   RowBox[{
    RowBox[{"gamma", "[", 
     RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "n"}], "+", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "m"}], ")"}], "!"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "Pi", " ", "n", 
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "m"}], ")"}], "!"}]}], ")"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Pfunc", "[", 
     RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", "m", ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}], ",", "0", ",", "0"}], 
     "}"}]}], "\n", 
   RowBox[{
    RowBox[{"LegendrePDer", "[", 
     RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "m"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"n", "-", "m", "+", "1"}], ")"}], " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"n", ",", 
          RowBox[{"m", "-", "1"}], ",", 
          RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], "-", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", 
         RowBox[{"m", "+", "1"}], ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], ")"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendrePDerSin", "[", 
     RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sin", "[", "theta", "]"}], " ", 
     RowBox[{"LegendrePDer", "[", 
      RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mLegendrePDividedBySin", "[", 
     RowBox[{"n_", ",", "m_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"LegendreP", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", 
         RowBox[{"m", "+", "1"}], ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "m", "-", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"n", "+", "m"}], ")"}], " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", 
          RowBox[{"m", "-", "1"}], ",", 
          RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}]}], ")"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BSinfunc", "[", 
     RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"LegendrePDerSin", "[", 
        RowBox[{"n", ",", "m", ",", "theta"}], "]"}], ",", 
       RowBox[{"I", " ", "m", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"n", ",", "m", ",", 
          RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}]}], "}"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CSinfunc", "[", 
     RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"I", " ", "m", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"n", ",", "m", ",", 
          RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"LegendrePDerSin", "[", 
         RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MSinfunc", "[", 
     RowBox[{
     "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"m", ",", "n"}], "]"}], " ", 
     RowBox[{"SphericalHankelH1", "[", 
      RowBox[{"n", ",", 
       RowBox[{"k", " ", "R"}]}], "]"}], " ", 
     RowBox[{"CSinfunc", "[", 
      RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"NSinfunc", "[", 
     RowBox[{
     "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"m", ",", "n"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"SphericalHankelH1", "[", 
          RowBox[{"n", ",", 
           RowBox[{"k", " ", "R"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"k", " ", "R"}], ")"}]}], " ", 
        RowBox[{"Pfunc", "[", 
         RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}], " ", 
        RowBox[{"Sin", "[", "theta", "]"}]}], "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"hRDer", "[", 
          RowBox[{"n", ",", "k", ",", "R"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"k", " ", "R"}], ")"}]}], " ", 
        RowBox[{"BSinfunc", "[", 
         RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}], 
      ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"Bfunc", "[", 
     RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"LegendrePDer", "[", 
        RowBox[{"n", ",", "m", ",", "theta"}], "]"}], ",", 
       RowBox[{"I", " ", 
        RowBox[{"mLegendrePDividedBySin", "[", 
         RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"Cfunc", "[", 
     RowBox[{"m_", ",", "n_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"I", " ", 
        RowBox[{"mLegendrePDividedBySin", "[", 
         RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"LegendrePDer", "[", 
         RowBox[{"n", ",", "m", ",", "theta"}], "]"}]}]}], "}"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "phi"}], "]"}]}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"Amn", "[", 
     RowBox[{"gdata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "Pi", " ", 
        RowBox[{"gamma", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"gdata", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], 
     RowBox[{"1", "/", 
      RowBox[{"SphericalHankelH1", "[", 
       RowBox[{"n", ",", 
        RowBox[{"k", " ", "R"}]}], "]"}]}]}]}], "\n", 
   RowBox[{
    RowBox[{"Bmn", "[", 
     RowBox[{"edata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "Pi", " ", 
        RowBox[{"gamma", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"edata", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], "k", " ", 
     RowBox[{"R", "/", 
      RowBox[{"hRDer", "[", 
       RowBox[{"n", ",", "k", ",", "R"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.924761210600356*^9, 3.9247612197898817`*^9}, {
   3.924762033205001*^9, 3.9247620521310835`*^9}, 3.9305643925989428`*^9, {
   3.930564481122533*^9, 3.9305645151026487`*^9}, 3.9305648680405216`*^9, 
   3.930731916383336*^9, {3.931324755403281*^9, 3.9313247770230236`*^9}, {
   3.931328501031901*^9, 3.9313285162756166`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lectura de datos", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fileEx", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ex.txt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileEy", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ey.txt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileEz", "=", 
   RowBox[{
   "OpenRead", "[", 
    "\"\<C:\\\\Users\\\\aitor\\\\OneDrive\\\\Desktop\\\\TFG-AitorIngelmo\\\\\
Matematica\\\\Notebook NFtoNF - \
Esferico\\\\python_processed_microstrip_patch_antenna_Ez.txt\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.930564332475895*^9, 3.930564337155149*^9}, {
   3.9305646818613586`*^9, 3.930564683741576*^9}, 3.9310628014439063`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"En", " ", "esta", " ", "celda"}], ",", " ", 
    RowBox[{
    "leemos", " ", "las", " ", "8", " ", "primeras", " ", "lineas", " ", "de",
      " ", "los", " ", 
     RowBox[{"ficheros", ".", " ", "Las"}], " ", "cuales", " ", "coinciden", 
     " ", "con", " ", "las", " ", "cabeceras", " ", "del", " ", 
     "m\[IAcute]smo"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEx", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEy", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Read", "[", 
       RowBox[{"fileEz", ",", "String"}], "]"}], ",", 
      RowBox[{"{", "0", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"En", " ", "estas", " ", "celdas"}], ",", " ", 
     RowBox[{
     "mostramos", " ", "lo", " ", "leido", " ", "en", " ", "la", " ", "celda",
       " ", 
      RowBox[{"anterior", ".", " ", "De"}], " ", "esta", " ", "forma"}], ",", 
     " ", 
     RowBox[{
     "nos", " ", "aseguramos", " ", "de", " ", "que", " ", "hemos", " ", 
      "leido", " ", "las", " ", 
      RowBox[{"cabeceras", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"headerdataEx", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEx", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"headerdataEy", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEy", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"headerdataEz", "=", 
     RowBox[{"Read", "[", 
      RowBox[{"fileEz", ",", "String"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataEx", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEx", ",", "String"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dataEy", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEy", ",", "String"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dataEz", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"fileEz", ",", "String"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.930565217538348*^9, {3.930731925163846*^9, 3.930731933323163*^9}, {
   3.93106280544018*^9, 3.93106283490984*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Cerramos", " ", "el", " ", "objeto", " ", "que", " ", "lee", " ", "los", 
    " ", "archivos"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Close", "[", "fileEx", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", "fileEy", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", "fileEz", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914148311409674`*^9, 3.8914148350005474`*^9}, {
  3.891415741600342*^9, 3.891415742666151*^9}, {3.8918567644166265`*^9, 
  3.8918567892492003`*^9}, {3.930564693189658*^9, 3.9305646947253056`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Esta", " ", "celda", " ", "nos", " ", "permite", " ", "separar", " ", 
    "la", " ", "cadena", " ", "de", " ", "texto", " ", "en", " ", 
    RowBox[{"diversas", ".", " ", "Emplea"}], " ", "espacios", " ", "en", " ",
     "blanco", " ", "como", " ", "separado"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datasetExSplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEx", ",", "\"\<;\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetEySplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEy", ",", "\"\<;\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasetEzSplitted", "=", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"dataEz", ",", "\"\<;\>\""}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914185203912582`*^9, 3.891418532791583*^9}, {
   3.891856813849495*^9, 3.8918568796887083`*^9}, {3.8918589532049875`*^9, 
   3.8918589535264177`*^9}, 3.8918592288209295`*^9, {3.931062851372012*^9, 
   3.931062853704591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ex"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEx", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetExSplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEx", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEx", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
   3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
   3.9308839865149612`*^9}, {3.9308845760636473`*^9, 
   3.9308845856561885`*^9}, {3.9310628646173983`*^9, 3.9310628834581995`*^9}, 
   3.9310644206298103`*^9, {3.9310647394260883`*^9, 3.9310647480310116`*^9}, {
   3.9310647986824894`*^9, 3.931064883573431*^9}, {3.931065021205163*^9, 
   3.931065046298027*^9}, {3.9310651247316475`*^9, 3.931065135550496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ey"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEy", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetEySplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEy", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEy", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
  3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
  3.930884035746376*^9}, {3.93088459317561*^9, 3.930884597983731*^9}, {
  3.931065029609804*^9, 3.9310650599979296`*^9}, {3.9310651037164764`*^9, 
  3.931065106002347*^9}, {3.931065139275794*^9, 3.9310651453613615`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtenci\[OAcute]n", " ", "de", " ", "los", " ", "tensores", " ", "de", 
    " ", "Ez"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"datavaluesEz", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Thread", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"f", "[", 
           RowBox[{"datasetEzSplitted", ",", "a"}], "]"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], ",", 
            RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
            RowBox[{"\"\<NaN\>\"", "\[Rule]", "\"\<0\>\""}]}], "}"}]}], ",", 
         RowBox[{"f", "->", "StringReplace"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xcoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ycoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zcoordinatesTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datavaluesEzTensorEz", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{"datavaluesEz", ",", "All", ",", "4"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8914233025118933`*^9, 3.8914233072634478`*^9}, {
  3.9308838666681175`*^9, 3.9308839077540617`*^9}, {3.930883967210699*^9, 
  3.930884080754927*^9}, {3.9308846023274417`*^9, 3.930884606735462*^9}, {
  3.93106514978941*^9, 3.931065163324697*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creaci\[OAcute]n de los interpoladores", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ex"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ExComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEx", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEx", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEx", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"ExComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876066961856`*^9}, {3.9308876410230155`*^9, 3.9308876413734975`*^9}, 
   3.930887692749398*^9, {3.931065314146558*^9, 3.9310653570373597`*^9}, 
   3.9310661591206875`*^9, 3.9310804095864735`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ey"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EyComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEy", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEy", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEy", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EyInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"EyComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876943263874`*^9}, {3.931065365124513*^9, 3.9310653865424385`*^9}, 
   3.93106616075031*^9, 3.9310804081938114`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolador", " ", "de", " ", "Ez"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EzComponentData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xcoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ycoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"zcoordinatesTensorEz", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"datavaluesEzTensorEz", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "datavaluesEzTensorEz", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EzInterpolator", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"EzComponentData", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9308857882170076`*^9, 3.9308857886340485`*^9}, {
   3.9308858353771477`*^9, 3.93088592003183*^9}, {3.9308865065182557`*^9, 
   3.9308866019069138`*^9}, {3.9308867010766153`*^9, 
   3.9308867217574816`*^9}, {3.9308872335272727`*^9, 3.930887287041545*^9}, {
   3.930887397698365*^9, 3.930887412631694*^9}, {3.930887442636136*^9, 
   3.9308874536663866`*^9}, {3.9308876017907915`*^9, 
   3.9308876943263874`*^9}, {3.9308877361430407`*^9, 3.930887769533637*^9}, {
   3.9310653918917236`*^9, 3.9310654073675804`*^9}, 3.9310661615616713`*^9, 
   3.931080407305518*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Generaci\[OAcute]n de un conjunto de valores r, theta y phi con los que \
creamos una malla\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.931059235483864*^9, 3.9310592409718647`*^9}, 3.931141692908883*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thetaIni", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "Pi"}], "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaEnd", " ", "=", " ", 
   RowBox[{"Pi", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiIni", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiEnd", " ", "=", " ", 
   RowBox[{"2", "Pi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberOfValues", " ", "=", " ", "100"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9308884678725624`*^9, 3.930888484547901*^9}, {
   3.9308892542062325`*^9, 3.930889308390233*^9}, 3.931055709353503*^9, 
   3.931141692908883*^9, 3.93115091646986*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rLinspace", "=", 
   RowBox[{"{", "0.01", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaLinspace", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"thetaIni", ",", "thetaEnd"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLinspace", " ", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"phiIni", ",", "phiEnd"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.930887954968811*^9, 3.9308879623976808`*^9}, {
   3.9308880214336104`*^9, 3.930888049517823*^9}, {3.930888089627796*^9, 
   3.930888124038452*^9}, {3.93088817864353*^9, 3.9308882054030805`*^9}, {
   3.9308883427941637`*^9, 3.930888358538164*^9}, {3.9308884324499207`*^9, 
   3.9308884380343275`*^9}, {3.9308887911204104`*^9, 
   3.9308888019454107`*^9}, {3.93088897085616*^9, 3.9308889711591597`*^9}, {
   3.9308891790882816`*^9, 3.930889245286233*^9}, {3.930889301015232*^9, 
   3.930889322983232*^9}, {3.9310526672970595`*^9, 3.931052679741494*^9}, {
   3.9310528359217973`*^9, 3.9310528448838844`*^9}, {3.9310554676709166`*^9, 
   3.9310555604217253`*^9}, {3.931055849269913*^9, 3.931055870418481*^9}, {
   3.931056432673195*^9, 3.9310564333689084`*^9}, 3.931141692908883*^9, 
   3.9311467010550737`*^9, {3.931147162327526*^9, 3.931147163307892*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meshGrid", " ", "=", " ", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{"rLinspace", ",", "thetaLinspace", ",", "phiLinspace"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "rLinspace", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "thetaLinspace", "]"}]}], "]"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiGrid", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"meshGrid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "phiLinspace", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.931055563772594*^9, {3.9310556273833055`*^9, 3.9310556285263643`*^9}, {
   3.931058334688697*^9, 3.931058334905045*^9}, 3.93105930286038*^9, {
   3.9311416536109104`*^9, 3.9311416544036393`*^9}, 3.931141692909882*^9, {
   3.9311466346257286`*^9, 3.931146638395994*^9}, {3.9311467355749464`*^9, 
   3.931146753202015*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformar los valores r, theta y phi en cartesianas", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.9310592477878637`*^9, 3.931059248139864*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xValueFromSpherical", " ", "=", " ", 
   RowBox[{"rGrid", "*", 
    RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
    RowBox[{"Cos", "[", "phiGrid", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yValueFromSpherical", " ", "=", " ", 
   RowBox[{"rGrid", "*", 
    RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
    RowBox[{"Sin", "[", "phiGrid", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zValueFromSpherical", " ", "=", " ", 
    RowBox[{"rGrid", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsToInterpolate", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
     "xValueFromSpherical", ",", "yValueFromSpherical", ",", 
      "zValueFromSpherical"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9310530164186788`*^9, 3.9310531154476333`*^9}, {
   3.9310539918276224`*^9, 3.931054036435073*^9}, {3.931054171476544*^9, 
   3.9310541889146147`*^9}, 3.931054663667223*^9, 3.931056330380823*^9, {
   3.9310588015570574`*^9, 3.931058828235508*^9}, {3.9310590559449987`*^9, 
   3.931059059557906*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculamos los valroes Ex, Ey y Ez interpolados", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ExInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EyInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"EyInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzInterpolated", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"EzInterpolator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pointsToInterpolate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointsToInterpolate", "]"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931059136308901*^9, 3.9310591997051663`*^9}, {
  3.931066677817153*^9, 3.9310667015299544`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Cambiamos las coordenadas de las componentes Ex, Ey y Ez a esf\[EAcute]ricas\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}, {
   3.931143926811343*^9, 3.931143945503505*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Er", " ", "=", "  ", 
   RowBox[{
    RowBox[{"ExInterpolated", " ", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", " ", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}], "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EzInterpolated", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Etheta", " ", "=", " ", 
   RowBox[{
    RowBox[{"ExInterpolated", " ", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}], "*", " ", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Cos", "[", "thetaGrid", "]"}], "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "-", " ", 
    RowBox[{"EzInterpolated", "*", 
     RowBox[{"Sin", "[", "thetaGrid", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ephi", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ExInterpolated"}], " ", "*", 
     RowBox[{"Sin", "[", "phiGrid", "]"}]}], " ", "+", " ", 
    RowBox[{"EyInterpolated", "*", 
     RowBox[{"Cos", "[", "phiGrid", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931143955254555*^9, 3.931144055169664*^9}, {
  3.931144088881974*^9, 3.9311440969049025`*^9}, {3.931144562518724*^9, 
  3.9311445764785547`*^9}, {3.9311453801333046`*^9, 3.9311453819486847`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculamos los valores emn y gmn\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}, {
   3.931143926811343*^9, 3.931143945503505*^9}, {3.931144694655033*^9, 
   3.9311447059137754`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numberOfModes", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta", " ", "=", " ", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"thetaLinspace", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
     RowBox[{"Abs", "[", 
      RowBox[{"thetaLinspace", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaPhi", " ", "=", " ", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"phiLinspace", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
     RowBox[{"Abs", "[", 
      RowBox[{"phiLinspace", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9311455737413845`*^9, 3.931145577850969*^9}, {
   3.9311462608962164`*^9, 3.9311463208718033`*^9}, 3.931146378143506*^9, {
   3.9311468086471815`*^9, 3.9311468277762566`*^9}, 3.9312622555748715`*^9, 
   3.9312705792785482`*^9, 3.931326760064047*^9, {3.931327381264423*^9, 
   3.931327442679854*^9}, {3.9313289708427687`*^9, 3.931328972927631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"emn", " ", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"deltaTheta", "*", "deltaPhi", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaIndex", "=", "1"}], 
        RowBox[{"Length", "[", "thetaLinspace", "]"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiIndex", "=", "1"}], 
         RowBox[{"Length", "[", "phiLinspace", "]"}]], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Er", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"Etheta", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "0"}], "}"}], ".", 
         RowBox[{"BSinfunc", "[", 
          RowBox[{
           RowBox[{"-", "m"}], ",", "n", ",", 
           RowBox[{"thetaLinspace", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"phiLinspace", "[", 
            RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", "emn", "]"}], " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9311460558629723`*^9, 3.9311460753971663`*^9}, {
   3.931146360912691*^9, 3.9311463627605553`*^9}, {3.9311515555817404`*^9, 
   3.9311515760940557`*^9}, 3.9311529214218645`*^9, {3.93127114659786*^9, 
   3.9312711519171963`*^9}, {3.931326367192152*^9, 3.931326380965109*^9}, 
   3.9313265449315543`*^9, {3.931328310629916*^9, 3.931328311902873*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.00955189755409334`"}], "+", 
       RowBox[{"0.01489179741005841`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9363792129937777`"}], "+", 
       RowBox[{"1.4566834008295535`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.004775948777046664`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.007445898705029208`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9313252690600224`*^9, 3.9313264070172834`*^9, 3.9313267642891555`*^9, 
   3.9313274574849157`*^9, {3.9313283113332295`*^9, 3.9313283198376684`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"emn", ",", 
    RowBox[{"10", "^", 
     RowBox[{"-", "1"}]}]}], "]"}], " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9312711715479593`*^9, 3.93127119178047*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "0.9363792129937777`"}], "+", 
          RowBox[{"1.4566834008295535`", " ", "\[ImaginaryI]"}]}], ",", "0"}],
         "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "1.877077198760395`"}], "+", 
          RowBox[{"2.9225977200243585`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.19660118634785495`"}], "+", 
          RowBox[{"0.30581179524015917`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "1.8352762420660613`"}], "+", 
          RowBox[{"2.86384137511979`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.3340682600038511`", "\[VeryThinSpace]", "-", 
          RowBox[{"2.073598098155856`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.5116366168610939`"}], "+", 
          RowBox[{"0.7981545927924661`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.10391097037380449`"}], "+", 
          RowBox[{"0.16001973307061776`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.1301509213828136`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6983062458519584`"}], "+", 
          RowBox[{"1.1020003244318217`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", "0", ",", "0"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11.219957446451318`"}], "+", 
          RowBox[{"17.429402173966476`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"4.9367754092225695`", "\[VeryThinSpace]", "-", 
          RowBox[{"7.688696449820753`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.10514550548573019`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.15197082025881048`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.44525914932673444`"}], "+", 
          RowBox[{"0.6904430591015578`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.12073923160774075`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.660688613289292`", "\[VeryThinSpace]", "-", 
          RowBox[{"1.0105213126750545`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.931270748437709*^9, {3.9312711569763527`*^9, 3.9312711927689815`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gmn", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"deltaTheta", "*", "deltaPhi", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaIndex", "=", "1"}], 
        RowBox[{"Length", "[", "thetaLinspace", "]"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiIndex", "=", "1"}], 
         RowBox[{"Length", "[", "phiLinspace", "]"}]], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Er", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"Etheta", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "0"}], "}"}], ".", 
         RowBox[{"CSinfunc", "[", 
          RowBox[{
           RowBox[{"-", "m"}], ",", "n", ",", 
           RowBox[{"thetaLinspace", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"phiLinspace", "[", 
            RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", "gmn", "]"}], " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.931325180658335*^9, 3.9313252229940767`*^9}, 
   3.931325287431378*^9, 3.9313283329257097`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.0004842456984631291`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00032295008813878264`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.000242122849231565`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0001614750440693874`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.931328335953658*^9, 3.931328345932207*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Amn", "[", 
   RowBox[{"gdata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"gamma", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"gdata", "[", 
     RowBox[{"[", "n", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], 
   RowBox[{"1", "/", 
    RowBox[{"SphericalHankelH1", "[", 
     RowBox[{"n", ",", 
      RowBox[{"k", " ", "R"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Bmn", "[", 
   RowBox[{"edata_", ",", "m_", ",", "n_", ",", "k_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", "m"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"gamma", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"edata", "[", 
     RowBox[{"[", "n", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"n", "+", "m", "+", "1"}], "]"}], "]"}], "k", " ", 
   RowBox[{"R", "/", 
    RowBox[{"hRDer", "[", 
     RowBox[{"n", ",", "k", ",", "R"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.931325943215481*^9, 3.9313259852726693`*^9}, {
  3.931326015599092*^9, 3.931326041203802*^9}, {3.931328493931552*^9, 
  3.931328495046232*^9}, {3.9313285314195623`*^9, 3.9313285340228224`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", " ", "=", 
   RowBox[{"1.5750", "^", "9"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "Pi", "*", "f"}], ")"}], "/", 
    RowBox[{"3", "^", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", "1."}], ";"}]}], "Input",
 CellChangeTimes->{{3.9313287252028675`*^9, 3.931328795002025*^9}, {
   3.9313288310029793`*^9, 3.9313288653232374`*^9}, 3.9313289360389724`*^9, {
   3.931328994037159*^9, 3.931328994955885*^9}, {3.9313291259705553`*^9, 
   3.931329136716525*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AmnSingleValue", " ", "=", " ", 
   RowBox[{"Amn", "[", 
    RowBox[{"gmn", ",", "0", ",", "1", ",", "K", ",", "R"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "AmnSingleValue", "]"}]}], "Input",
 CellChangeTimes->{{3.93132866729904*^9, 3.931328688850769*^9}, {
  3.9313287990422583`*^9, 3.9313288005222936`*^9}, {3.9313288477811384`*^9, 
  3.9313288782176447`*^9}, {3.9313289889522815`*^9, 3.9313289898637395`*^9}, {
  3.931329111745348*^9, 3.9313291194887714`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AmnSingleValue", " ", "=", " ", 
   RowBox[{"Bmn", "[", 
    RowBox[{"emn", ",", "0", ",", "1", ",", "K", ",", "R"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "AmnSingleValue", "]"}]}], "Input",
 CellChangeTimes->{{3.93132866729904*^9, 3.931328688850769*^9}, {
  3.9313287990422583`*^9, 3.9313288005222936`*^9}, {3.9313288477811384`*^9, 
  3.9313288782176447`*^9}, {3.9313289889522815`*^9, 3.9313289898637395`*^9}, {
  3.931329111745348*^9, 3.9313291194887714`*^9}, {3.931329582615712*^9, 
  3.9313295850401754`*^9}}],

Cell[BoxData[
 RowBox[{"0.0000626024904786713`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.000040252874057906246`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.931329586187193*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thetaValues", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiValues", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta", " ", "=", " ", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"thetaValues", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
     RowBox[{"Abs", "[", 
      RowBox[{"thetaValues", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaPhi", " ", "=", " ", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"phiValues", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
     RowBox[{"Abs", "[", 
      RowBox[{"phiValues", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MSinfunc", "[", 
   RowBox[{
   "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"gamma", "[", 
    RowBox[{"m", ",", "n"}], "]"}], " ", 
   RowBox[{"SphericalHankelH1", "[", 
    RowBox[{"n", ",", 
     RowBox[{"k", " ", "R"}]}], "]"}], " ", 
   RowBox[{"CSinfunc", "[", 
    RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"NSinfunc", "[", 
   RowBox[{
   "m_", ",", "n_", ",", "k_", ",", "R_", ",", "theta_", ",", "phi_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"gamma", "[", 
    RowBox[{"m", ",", "n"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], " ", 
      RowBox[{
       RowBox[{"SphericalHankelH1", "[", 
        RowBox[{"n", ",", 
         RowBox[{"k", " ", "R"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", "R"}], ")"}]}], " ", 
      RowBox[{"Pfunc", "[", 
       RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"hRDer", "[", 
        RowBox[{"n", ",", "k", ",", "R"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", "R"}], ")"}]}], " ", 
      RowBox[{"BSinfunc", "[", 
       RowBox[{"m", ",", "n", ",", "theta", ",", "phi"}], "]"}]}]}], 
    ")"}]}]}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparaci\[OAcute]n con los valores del Dipolo te\[OAcute]rico\
\>", "Section",
 CellChangeTimes->{{3.9137028848286033`*^9, 3.9137029474050255`*^9}, 
   3.9249292475372286`*^9, {3.928929757921319*^9, 3.928929820504876*^9}, {
   3.9305642406184607`*^9, 3.9305642583580275`*^9}, {3.9308858072239485`*^9, 
   3.930885813503443*^9}, {3.9308879358043437`*^9, 3.9308879500281615`*^9}, {
   3.9310528735854993`*^9, 3.93105288359179*^9}, {3.9310554176023397`*^9, 
   3.931055427397981*^9}, {3.931059096341256*^9, 3.9310591104704275`*^9}, {
   3.931143926811343*^9, 3.931143945503505*^9}, {3.931144694655033*^9, 
   3.9311447059137754`*^9}, {3.931328380868597*^9, 3.931328391533536*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edipoler", "[", 
   RowBox[{
   "r_", ",", "theta_", ",", "k_", ",", "eta_", ",", "l_", ",", "I0_"}], 
   "]"}], ":=", 
  RowBox[{"eta", " ", "I0", " ", "l", " ", 
   RowBox[{
    RowBox[{"Cos", "[", "theta", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "Pi", " ", 
      RowBox[{"r", "^", "2"}]}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "k", " ", "r"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "k", " ", "r"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Edipoletheta", "[", 
   RowBox[{
   "r_", ",", "theta_", ",", "k_", ",", "eta_", ",", "l_", ",", "I0_"}], 
   "]"}], ":=", 
  RowBox[{"I", " ", "eta", " ", "k", " ", "I0", " ", "l", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", "Pi", " ", "r"}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "k", " ", "r"}], ")"}]}], "-", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", " ", "r"}], ")"}], "^", "2"}]}]}], ")"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "k", " ", "r"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.913206954070815*^9, 3.9132070565034614`*^9}, {
  3.9132070878933434`*^9, 3.913207090154496*^9}, {3.9132074408272057`*^9, 
  3.913207441315274*^9}, {3.9313275107760143`*^9, 3.9313275110225024`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edatadipole", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lambda", "=", "1"}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"1", " ", "lambda"}]}], ",", 
         RowBox[{"I0", "=", "1"}], ",", 
         RowBox[{"l", "=", 
          RowBox[{"lambda", "/", "50"}]}], ",", " ", 
         RowBox[{"k", "=", 
          RowBox[{"2", " ", 
           RowBox[{"Pi", "/", "lambda"}]}]}], ",", 
         RowBox[{"eta", "=", 
          RowBox[{"120", " ", "Pi"}]}], ",", 
         RowBox[{"numberOfModes", "=", "5"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Edipoler", "[", 
               RowBox[{
               "r", ",", "theta", ",", "k", ",", "eta", ",", "l", ",", "I0"}],
                "]"}], ",", 
              RowBox[{"Edipoletheta", "[", 
               RowBox[{
               "r", ",", "theta", ",", "k", ",", "eta", ",", "l", ",", "I0"}],
                "]"}], ",", "0"}], "}"}], ".", 
            RowBox[{"BSinfunc", "[", 
             RowBox[{
              RowBox[{"-", "m"}], ",", "n", ",", "theta", ",", "phi"}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"phi", ",", "0", ",", 
             RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0", ",", "Pi"}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Trapezoidal\>\""}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"edatadipole", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.913207061327961*^9, 3.913207081848273*^9}, {
   3.913207125762285*^9, 3.913207165071419*^9}, {3.91320744507514*^9, 
   3.913207450138739*^9}, 3.9132074882920794`*^9, 3.9313275097429514`*^9, {
   3.9313276391592083`*^9, 3.931327643666921*^9}, {3.931327779263259*^9, 
   3.9313277845396814`*^9}, {3.931327912648347*^9, 3.9313279185413036`*^9}, 
   3.9313281545180235`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvi"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] iterated refinements in \
\[NoBreak]\\!\\(theta\\)\[NoBreak] in the region \[NoBreak]\\!\\({\\(\\({0.`, \
6.283185307179586`}\\)\\), \\(\\({0.`, \
3.141592653589793`}\\)\\)}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(3.469446951953614`*^-18 - \\(\\(7.45931094670027`*^-17\\\\ \
\[ImaginaryI]\\)\\)\\)\[NoBreak] and \
\[NoBreak]\\!\\(1.514749816431168`*^-16\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvi\\\", ButtonNote -> \
\\\"NIntegrate::ncvi\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.9313279015705924`*^9, 3.9313279196698704`*^9}, 
   3.9313281551493273`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvi"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] iterated refinements in \
\[NoBreak]\\!\\(theta\\)\[NoBreak] in the region \[NoBreak]\\!\\({\\(\\({0.`, \
6.283185307179586`}\\)\\), \\(\\({0.`, \
3.141592653589793`}\\)\\)}\\)\[NoBreak]. NIntegrate obtained \[NoBreak]\\!\\(\
\\(\\(-5.026554096029985`\\)\\) - \\(\\(30.78276991081698`\\\\ \
\[ImaginaryI]\\)\\)\\)\[NoBreak] and \
\[NoBreak]\\!\\(0.0005485612664364477`\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvi\\\", ButtonNote -> \
\\\"NIntegrate::ncvi\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.9313279015705924`*^9, 3.9313279196698704`*^9}, 
   3.9313281551793594`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvi"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] iterated refinements in \
\[NoBreak]\\!\\(theta\\)\[NoBreak] in the region \[NoBreak]\\!\\({\\(\\({0.`, \
6.283185307179586`}\\)\\), \\(\\({0.`, \
3.141592653589793`}\\)\\)}\\)\[NoBreak]. NIntegrate obtained \[NoBreak]\\!\\(\
\\(\\(-1.6479873021779667`*^-17\\)\\) - \\(\\(1.0408340855860843`*^-17\\\\ \
\[ImaginaryI]\\)\\)\\)\[NoBreak] and \
\[NoBreak]\\!\\(1.549926965245323`*^-16\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvi\\\", ButtonNote -> \
\\\"NIntegrate::ncvi\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.9313279015705924`*^9, 3.9313279196698704`*^9}, 
   3.9313281551943274`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: ncvi\\), \\\"MessageName\\\"]\\)\
\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.9313279015705924`*^9, 3.9313279196698704`*^9}, 
   3.931328155208359*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.469446951953614`*^-18", "-", 
          RowBox[{"7.45931094670027`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "5.026554096029985`"}], "-", 
          RowBox[{"30.78276991081698`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.6479873021779667`*^-17"}], "-", 
          RowBox[{"1.0408340855860843`*^-17", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.734723475976807`*^-17"}], "-", 
          RowBox[{"2.2898349882893854`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.887379141862766`*^-15", "-", 
          RowBox[{"1.6653345369377348`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.1102230246251565`*^-16"}], "-", 
          RowBox[{"2.220446049250313`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"5.204170427930421`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "2.3852447794681098`*^-18"}], "+", 
          RowBox[{"5.204170427930421`*^-18", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3.011479954295737`*^-15"}], "-", 
          RowBox[{"6.938893903907228`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "8.520961713998076`*^-15"}], "+", 
          RowBox[{"2.7755575615628914`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"2.914335439641036`*^-16", "+", 
          RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.00003530434288576611`"}], "-", 
          RowBox[{"0.00021620486781692184`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.457167719820518`*^-16", "+", 
          RowBox[{"2.949029909160572`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.0148132334464322`*^-16", "+", 
          RowBox[{"2.168404344971009`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"9.215718466126788`*^-19", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.986499936241671`*^-14", "-", 
          RowBox[{"8.43769498715119`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.0835776720341528`*^-13", "-", 
          RowBox[{"1.9095836023552692`*^-13", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "4.760081218080359`*^-15"}], "-", 
          RowBox[{"6.938893903907228`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "5.551115123125783`*^-17"}], "-", 
          RowBox[{"1.1379786002407855`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"3.191891195797325`*^-16", "-", 
          RowBox[{"2.220446049250313`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"5.551115123125783`*^-17", "+", 
          RowBox[{"1.0755285551056204`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "3.2526065174565133`*^-18"}], "-", 
          RowBox[{"8.05020113070487`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.1275702593849246`*^-17", "+", 
          RowBox[{"9.784924606681678`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.1180834903756764`*^-19"}], "-", 
          RowBox[{"8.131516293641283`*^-20", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.2434497875801753`*^-14", "+", 
          RowBox[{"3.481659405224491`*^-13", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"3.623767952376511`*^-13", "+", 
          RowBox[{"2.3661073100811336`*^-12", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "3.247402347028583`*^-15"}], "-", 
          RowBox[{"3.297362383136715`*^-14", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.1962653090336062`*^-14"}], "+", 
          RowBox[{"5.662137425588298`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "4.85722573273506`*^-16"}], "+", 
          RowBox[{"6.800116025829084`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.00008918356625527406`"}], "-", 
          RowBox[{"0.0005461628677224141`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "6.5052130349130266`*^-18"}], "+", 
          RowBox[{"3.0357660829594124`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"7.914675859144182`*^-18", "-", 
          RowBox[{"7.589415207398531`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"2.4191260973582818`*^-18", "+", 
          RowBox[{"1.3823577699190182`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.0842021724855044`*^-18", "+", 
          RowBox[{"6.776263578034403`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.088437337221776`*^-19", "+", 
          RowBox[{"1.1011428314305904`*^-19", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.93132790170222*^9, 3.9313279198028684`*^9}, 
   3.931328155285671*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"1", " ", "lambda"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"lambda", "/", "50"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"2", " ", 
    RowBox[{"Pi", "/", "lambda"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "=", 
   RowBox[{"120", " ", "Pi"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9313277345114417`*^9, 3.9313277372787013`*^9}, {
  3.931327788126337*^9, 3.9313278034777184`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numberOfModes", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetaLinspace", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLinspace", " ", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"f", ",", "numberOfValues", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deltaTheta", " ", "=", " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"thetaLinspace", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
    RowBox[{"Abs", "[", 
     RowBox[{"thetaLinspace", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"deltaPhi", " ", "=", " ", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"phiLinspace", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "-", "  ", 
    RowBox[{"Abs", "[", 
     RowBox[{"phiLinspace", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.931327953975024*^9, 3.9313279653129272`*^9}}],

Cell[BoxData[
 FractionBox["\[Pi]", "99"]], "Output",
 CellChangeTimes->{3.931327966751644*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]"}], "99"]], "Output",
 CellChangeTimes->{3.931327966755643*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"emn", " ", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"deltaTheta", "*", "deltaPhi", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"thetaIndex", "=", "1"}], 
        RowBox[{"Length", "[", "thetaLinspace", "]"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"phiIndex", "=", "1"}], 
         RowBox[{"Length", "[", "phiLinspace", "]"}]], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Edipoletheta", "[", 
            RowBox[{"r", ",", 
             RowBox[{"thetaLinspace", "[", 
              RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", "k", ",", "eta", 
             ",", "l", ",", "I0"}], "]"}], ",", "0"}], "}"}], ".", 
         RowBox[{"BSinfunc", "[", 
          RowBox[{
           RowBox[{"-", "m"}], ",", "n", ",", 
           RowBox[{"thetaLinspace", "[", 
            RowBox[{"[", "thetaIndex", "]"}], "]"}], ",", 
           RowBox[{"phiLinspace", "[", 
            RowBox[{"[", "phiIndex", "]"}], "]"}]}], "]"}]}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "numberOfModes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"emn", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9313277138958473`*^9, 3.931327724100443*^9}, {
  3.9313278143429966`*^9, 3.9313278179356112`*^9}, {3.931328246254835*^9, 
  3.9313282484185843`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.9313279767360873`*^9, 3.931328195551061*^9, 
  3.9313282566140547`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.9313279767360873`*^9, 3.931328195551061*^9, 
  3.9313282566400833`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.9313279767360873`*^9, 3.931328195551061*^9, 
  3.931328256668082*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.9313279767360873`*^9, 3.931328195551061*^9, 
  3.931328256682085*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2.0116909780915074`*^-17", "-", 
       RowBox[{"2.7668611846119647`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "5.077321524720694`"}], "-", 
       RowBox[{"31.09367118562558`", " ", "\[ImaginaryI]"}]}], "Indeterminate"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9313278266802177`*^9, 3.9313279768071237`*^9, 
  3.931328195622061*^9, 3.9313282566860523`*^9}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1906, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.600000023841858,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 575, 8, 136, "Section"],
Cell[1157, 32, 8795, 250, 686, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9989, 287, 233, 3, 125, "Section"],
Cell[10225, 292, 1016, 26, 367, "Input"],
Cell[11244, 320, 2537, 71, 338, "Input"],
Cell[13784, 393, 664, 15, 135, "Input"],
Cell[14451, 410, 1116, 26, 135, "Input"],
Cell[15570, 438, 2167, 52, 222, "Input"],
Cell[17740, 492, 2026, 50, 222, "Input"],
Cell[19769, 544, 1927, 49, 222, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21733, 598, 307, 4, 125, "Section"],
Cell[22043, 604, 1722, 40, 135, "Input"],
Cell[23768, 646, 1643, 39, 135, "Input"],
Cell[25414, 687, 1698, 40, 135, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27149, 732, 492, 8, 125, "Section"],
Cell[27644, 742, 709, 17, 164, "Input"],
Cell[28356, 761, 1562, 32, 164, "Input"],
Cell[29921, 795, 1672, 45, 135, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31630, 845, 523, 6, 125, "Section"],
Cell[32156, 853, 1214, 28, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33407, 886, 517, 6, 125, "Section"],
Cell[33927, 894, 2463, 68, 193, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36427, 967, 604, 9, 125, "Section"],
Cell[37034, 978, 1481, 35, 106, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38552, 1018, 612, 10, 125, "Section"],
Cell[39167, 1030, 1186, 28, 106, "Input"],
Cell[CellGroupData[{
Cell[40378, 1062, 1704, 40, 281, "Input"],
Cell[42085, 1104, 1127, 27, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43249, 1136, 235, 6, 47, "Input"],
Cell[43487, 1144, 3314, 79, 148, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46838, 1228, 1446, 37, 281, "Input"],
Cell[48287, 1267, 897, 21, 67, "Output"]
}, Open  ]],
Cell[49199, 1291, 1517, 44, 77, "Input"],
Cell[50719, 1337, 614, 15, 106, "Input"],
Cell[51336, 1354, 523, 10, 77, "Input"],
Cell[CellGroupData[{
Cell[51884, 1368, 574, 11, 77, "Input"],
Cell[52461, 1381, 191, 3, 79, "Output"]
}, Open  ]],
Cell[52667, 1387, 1168, 35, 135, "Input"],
Cell[53838, 1424, 1436, 44, 106, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55311, 1473, 688, 10, 125, "Section"],
Cell[56002, 1485, 1569, 45, 77, "Input"],
Cell[CellGroupData[{
Cell[57596, 1534, 2390, 59, 135, "Input"],
Cell[59989, 1595, 955, 18, 70, "Message"],
Cell[60947, 1615, 958, 18, 70, "Message"],
Cell[61908, 1635, 971, 18, 70, "Message"],
Cell[62882, 1655, 587, 12, 37, "Message"],
Cell[63472, 1669, 5857, 125, 213, "Output"]
}, Open  ]],
Cell[69344, 1797, 690, 19, 193, "Input"],
Cell[CellGroupData[{
Cell[70059, 1820, 1288, 35, 164, "Input"],
Cell[71350, 1857, 95, 2, 63, "Output"],
Cell[71448, 1861, 118, 3, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71603, 1869, 1543, 38, 281, "Input"],
Cell[73149, 1909, 526, 11, 37, "Message"],
Cell[73678, 1922, 526, 11, 37, "Message"],
Cell[74207, 1935, 524, 11, 37, "Message"],
Cell[74734, 1948, 581, 12, 37, "Message"],
Cell[75318, 1962, 939, 23, 69, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
