(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      7598,        221]
NotebookOptionsPosition[      7243,        204]
NotebookOutlinePosition[      7623,        220]
CellTagsIndexPosition[      7580,        217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Zn", "[", 
     RowBox[{"n_", ",", "c_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"c", "\[Equal]", "1"}], " ", ",", 
      RowBox[{"SphericalBesselJ", "[", 
       RowBox[{"n", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
      "                                  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "\[Equal]", "2"}], ",", 
        RowBox[{"SphericalBesselY", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
        "                                ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"c", "\[Equal]", "3"}], ",", 
          RowBox[{"SphericalHankelH1", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"SphericalHankelH2", "[", 
           RowBox[{"n", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fsmn", "[", 
     RowBox[{
     "s_", ",", "m_", ",", "n_", ",", "c_", ",", "theta_", ",", "phi_", ",", 
      "z_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"s", "\[Equal]", "1"}], " ", ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"2", "\[Pi]"}]]], " ", 
       FractionBox[
        RowBox[{"1", " "}], 
        SqrtBox[
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"-", "m"}], "m"], ")"}], "m"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Zn", "[", 
           RowBox[{"n", ",", "c", ",", "z"}], "]"}], " ", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "m", " ", 
            RowBox[{"LegendreP", "[", 
             RowBox[{"n", ",", "m", ",", 
              RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], 
           RowBox[{"Sin", "[", "theta", "]"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "phi"}]]}], 
         "\[IndentingNewLine]", "-", 
         RowBox[{
          RowBox[{"Zn", "[", 
           RowBox[{"n", ",", "c", ",", "z"}], "]"}], " ", 
          RowBox[{"LegendrePDerivadaCos", "[", 
           RowBox[{"n", ",", "m", ",", "theta"}], "]"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "phi"}]]}]}], " ", ")"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"2", "\[Pi]"}]]], " ", 
       FractionBox[
        RowBox[{"1", " "}], 
        SqrtBox[
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"-", "m"}], "m"], ")"}], "m"], 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], "z"], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Zn", "[", 
           RowBox[{"n", ",", "c", ",", "z"}], "]"}], " ", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"n", ",", "m", ",", 
            RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "phi"}]]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          FractionBox["1", "z"], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"z", " ", 
             RowBox[{"Zfunction", "[", 
              RowBox[{"n", ",", "c", ",", "z"}], "]"}]}], ",", "z"}], "]"}], 
          " ", 
          RowBox[{"LegendrePDerivadaCos", "[", 
           RowBox[{"n", ",", "m", ",", "theta"}], "]"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "phi"}]]}], " ", 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          FractionBox["1", "z"], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"z", " ", 
             RowBox[{"Zfunction", "[", 
              RowBox[{"n", ",", "c", ",", "z"}], "]"}]}], ",", "z"}], "]"}], 
          " ", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "m", " ", 
            RowBox[{"LegendreP", "[", 
             RowBox[{"n", ",", "m", ",", 
              RowBox[{"Cos", "[", "theta", "]"}]}], "]"}]}], 
           RowBox[{"Sin", "[", "theta", "]"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "phi"}]]}]}], ")"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Fsmn", "[", 
      RowBox[{
      "1", ",", "1", ",", "n", ",", "3", ",", "theta", ",", "phi", ",", "z"}],
       "]"}], ",", 
     RowBox[{"theta", "\[Rule]", "0"}], ",", 
     RowBox[{"Assumptions", "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"m", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.902134178971375*^9, 3.9021341808748207`*^9}, {
   3.9021342130919943`*^9, 3.902134328586059*^9}, {3.9021344757323723`*^9, 
   3.9021344801078186`*^9}, 3.902135004196454*^9}],

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", 
       RowBox[{"Csc", "[", "theta", "]"}], " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], " ", 
       RowBox[{"SphericalHankelH1", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", 
       RowBox[{"LegendrePDerivadaCos", "[", 
        RowBox[{"n", ",", "1", ",", "theta"}], "]"}], " ", 
       RowBox[{"SphericalHankelH1", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}]}], 
     RowBox[{
      SqrtBox[
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "n"}], ")"}]}]], " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]]}]]}], ",", 
   RowBox[{"theta", "\[Rule]", "0"}], ",", 
   RowBox[{"Assumptions", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"m", "\[Element]", "Integers"}], "}"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.9021343512171583`*^9, 3.9021344930707664`*^9, 
  3.9021350082005405`*^9}]
}, Open  ]]
},
WindowSize->{1904, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.7000001668930054`,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 5376, 143, 668, "Input"],
Cell[5958, 167, 1269, 34, 213, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
